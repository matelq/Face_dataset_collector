# Сборщик датасета

## Что это и зачем?

Это программа обхода видеоконтента на YouTube для сбора датасета обучения нейросетевой модели переноса лиц в высоком разрешении. Данная программа разработана при решении задач, полученных в процессе прохождения летней производственной практики 2021 г. в компании ООО "Метаперсона".

Искусственная нейронная сеть обычно обучается с учителем. Это означает наличие обучающего набора (датасета), который содержит примеры с истинными значениями: тегами, классами, показателями. Раньше люди вручную собирали датасет, в связи с чем были проблемы, например: ограниченный объем данных, человеческий фактор, время сбора. Но сейчас стало возможным собирать его автоматически, поэтому появился спрос на программы-сборщики датасетов для обучения.

### Примеры детекции
#### Пример извлечения .gif для одной из цепочек кадров
![[204_219.gif]]

#### Пример детекции нескольких лиц на отдельном кадре
![[Pasted image 20240710003739.png]]

## Результаты работы программы:
В результате работы генерируются следующие файлы и папки:
- ./
- urls_from_keys.csv # Содержит ссылки на видео и его тег из файла ключевых слов (key_words.csv)
- /YT_ID1/ # YT_ID - Идентификатор видео на YouTube
	- /deep_chains.csv # Содержит "цепочки" кадров в формате start_frame, end_frame
	- /deep_face_box.csv # Содержит покадровые нормализованные координаты рамки лица (bbox) в диапазоне \[0;1\]
- /YT_ID2/
	- /deep_chains.csv
	- /deep_face_box.csv
- ...
### Примеры файлов
#### urls_from_keys.csv
![[Pasted image 20240710003231.png]]

#### deep_chains.csv:
![[Pasted image 20240710003020.png]]

#### deep_face_box.csv
![[Pasted image 20240710003104.png]]

### Запуск в окружении Anaconda
Подключение необходимых библиотек
```
$ conda install -c conda-forge ffmpeg
$ pip install ffmpeg-python
$ pip install pytube
$ pip install mediapipe
```
Заполнить файл key_words.csv ключевыми словами и количеством страниц поиска(!) для каждого из них
![[Pasted image 20240710001435.png]]
Запустить main.py
```
$ python main.py
```
